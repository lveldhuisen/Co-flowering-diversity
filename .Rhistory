library(tidyverse)
setwd("~/Library/CloudStorage/OneDrive-UniversityofArizona/Arizona PhD/Research/RMBL/Summer 2021/Data files")
dat <- read.csv("Phenology_fitness_data_2021_trimmed.csv", header = TRUE)
kruskal.test(SI ~ site, data = Merged2021)
Merged2021 <- do.call("rbind", list(Road_21_melt, Pfeiler_21_melt, PBM_21_melt))
#2021 SI calculations and turned into data tables -------------------------
setwd("~/Library/CloudStorage/OneDrive-UniversityofArizona/Arizona PhD/Research/RMBL/Summer 2021/Data files")
mat_PBM_2021 <- read.csv("PBM_phenology_matrix_2021.csv", header = TRUE)
PBM_SI_2021 <- niche.overlap(mat_PBM_2021, method = "schoener")
library(spaa)
library(reshape)
library(reshape2)
#2021 SI calculations and turned into data tables -------------------------
setwd("~/Library/CloudStorage/OneDrive-UniversityofArizona/Arizona PhD/Research/RMBL/Summer 2021/Data files")
#PBM SI + dataframe 21
mat_PBM_2021 <- read.csv("PBM_phenology_matrix_2021.csv", header = TRUE)
#PBM SI + dataframe 21
mat_PBM_2021 <- read.csv("PBM_phenology_matrix_2021.csv", header = TRUE)
#PBM SI + dataframe 21
mat_PBM_2021 <- read.csv("PBM_phenology_matrix_2021.csv", header = TRUE)
PBM_SI_2021 <- niche.overlap(mat_PBM_2021, method = "schoener")
hist(PBM_SI_2021)
PBM_21_melt <- melt(as.matrix(PBM_SI_2021), varnames = c("species1"))
colnames(PBM_21_melt) <- c("species1", "species2", "SI")
PBM_21_melt$site <- c("PBM")
print(PBM_21_melt)
mat_Pfeiler_2021 <- read.csv("pfeiler_phenology_matrix_2021.csv", header = TRUE)
Pfeiler_SI_2021 <- niche.overlap(mat_Pfeiler_2021, method = "schoener")
hist(Pfeiler_SI_2021)
Pfeiler_21_melt <- melt(as.matrix(Pfeiler_SI_2021), varnames = c("species1"))
colnames(Pfeiler_21_melt) <- c("species1", "species2", "SI")
Pfeiler_21_melt$site <- c("Pfeiler")
print(Pfeiler_21_melt)
mat_Road_2021 <-read.csv("road_phenology_matrix_2021.csv", header = TRUE)
Road_SI_2021<-niche.overlap(mat_Road_2021, method = "schoener")
hist(Road_SI_2021)
Road_21_melt <- melt(as.matrix(Road_SI_2021), varnames = c("species1"))
colnames(Road_21_melt) <- c("species1", "species2", "SI")
Road_21_melt$site <- c("Road")
print(Road_21_melt)
Merged2021 <- do.call("rbind", list(Road_21_melt, Pfeiler_21_melt, PBM_21_melt))
print(Merged2021)
kruskal.test(SI ~ site, data = Merged2021)
chisq.test(Merged2021$site,Merged2021$SI)
ggboxplot(Merged2021, x = "site", y = "SI",
color = "site", palette = c("#00AFBB", "#E7B800", "#FC4E07"),
order = c("Road", "Pfeiler", "PBM"),
ylab = "Schoener's Index", xlab = "Site", title = "2021 phenology")
library(ggpubr)
#compare distributions for SI between sites 2021
library(tidyverse)
ggboxplot(Merged2021, x = "site", y = "SI",
color = "site", palette = c("#00AFBB", "#E7B800", "#FC4E07"),
order = c("Road", "Pfeiler", "PBM"),
ylab = "Schoener's Index", xlab = "Site", title = "2021 phenology")
ggboxplot(Merged2021, x = "site", y = "SI",
color = "site", palette = c("#00AFBB", "#E7B800", "#FC4E07"),
order = c("Road", "Pfeiler", "PBM"),
ylab = "Schoener's Index - phenology", xlab = "Site", title = "2021 phenology")
###remove zeros----------------------------
Merged_2021_nozeros <- filter(Merged2021, SI > 1.1E-15)
kruskal.test(SI ~ site, data = Merged_2021_nozeros)
ggboxplot(Merged_2021_nozeros, x = "site", y = "SI",
color = "site", palette = c("#00AFBB", "#E7B800", "#FC4E07"),
order = c("Road", "Pfeiler", "PBM"),
ylab = "Schoener's Index", xlab = "Site", title = "2021 phenology")
View(Merged2021)
etwd("~/Library/CloudStorage/OneDrive-UniversityofArizona/Arizona PhD/Research/RMBL/Summer 2022/data files")
setwd("~/Library/CloudStorage/OneDrive-UniversityofArizona/Arizona PhD/Research/RMBL/Summer 2022/data files")
mat_PBM_2022 <- read.csv("PBM_phenology_matrix_2022.csv", header = TRUE)
PBM_SI_22 <- niche.overlap(mat_PBM_2022, method = "schoener")
hist(PBM_SI_22)
mat_Pfeiler_2022 <- read.csv("Pfeiler_phenology_matrix_2022.csv", header = TRUE)
Pfeiler_SI_22 <- niche.overlap(mat_Pfeiler_2022, method = "schoener")
hist(Pfeiler_SI_22)
print(Pfeiler_SI_22)
mat_Road_2022 <- read.csv("Road_phenology_matrix_2022.csv", header = TRUE)
Road_SI_22 <- niche.overlap(mat_Road_2022, method = "schoener")
print(Road_SI_22)
Road_22_melt <- melt(as.matrix(Road_SI_22), varnames = c("species1"))
colnames(Road_22_melt) <- c("species1", "species2", "SI")
Road_22_melt$site <- c("Road")
print(Road_22_melt)
keeps <- c("species1","species2","SI","site")
Road_22_melt = Road_22_melt[keeps]
print(Road_22_melt)
Pfeiler_22_melt <- melt(as.matrix(Pfeiler_SI_22), varnames = c("species1"))
colnames(Pfeiler_22_melt) <- c("species1", "species2", "SI")
print(Pfeiler_22_melt)
Pfeiler_22_melt$site <- c("Pfeiler")
head(Pfeiler_22_melt)
keeps <- c("species1","species2","SI","site")
Pfeiler_22_melt = Pfeiler_22_melt[keeps]
print(Pfeiler_22_melt)
PBM_22_melt <- melt(as.matrix(PBM_SI_22), varnames = c("species1"))
colnames(PBM_22_melt) <- c("species1", "species2", "SI")
print(PBM_22_melt)
PBM_22_melt$site <- NA
PBM_22_melt$site <- c("PBM")
keeps <- c("species1","species2","SI","site")
PBM_22_melt = PBM_22_melt[keeps]
print(PBM_22_melt)
Merged2022 <- do.call("rbind", list(Road_22_melt, Pfeiler_22_melt, PBM_22_melt))
unique(Merged2022$site)
library(dplyr)
library(ggpubr)
library(ggplot2)
Merged22_nozero <- filter(Merged2022, SI > 1.11E-15)
head(Merged22_nozero)
hist(Merged22_nozero$SI)
kruskal.test(SI ~ site, data = Merged22_nozero)
ggboxplot(Merged22_nozero, x = "site", y = "SI",
color = "site", palette = c("#00AFBB", "#E7B800", "#FC4E07"),
order = c("Road", "Pfeiler", "PBM"),
ylab = "Schoener's Index", xlab = "Site", title = "2022")
ggboxplot(Merged22, x = "site", y = "SI",
color = "site", palette = c("#00AFBB", "#E7B800", "#FC4E07"),
order = c("Road", "Pfeiler", "PBM"),
ylab = "Schoener's Index", xlab = "Site", title = "2022")
ggboxplot(Merged2022, x = "site", y = "SI",
color = "site", palette = c("#00AFBB", "#E7B800", "#FC4E07"),
order = c("Road", "Pfeiler", "PBM"),
ylab = "Schoener's Index", xlab = "Site", title = "2022")
kruskal.test(SI ~ site, data = Merged2022)
View(Merged2021)
#test distributions of flowering
chisq.test(Merged2021$SI, Merged2021$site)
View(Merged2021)
#test distributions of flowering
kruskal.test(SI ~ site, data = Merged2021)
kruskal.test(SI ~ Site, data = Merged2022)
View(Merged2022)
kruskal.test(SI ~ site, data = Merged2022)
install.packages("FSA")
library(FSA)
dunnTest(SI ~ site,
data=Merged2022,
method="bonferroni")
setwd("/Users/leahvedlhuisen/Library/CloudStorage/OneDrive-UniversityofArizona/Arizona PhD/Research/Chapter 1")
fitness2021 <- read.csv("2021_fitness_data.csv", header = TRUE)
View(fitness2021)
x <- fitness2021
View(x)
x %>% group_by(Species) %>% summarise(X = sd(Number_of_fruits_per_tagged_unit))
x %>% group_by(Species) %>% summarise(X = mean(Number_of_fruits_per_tagged_unit))
aggregate(x$Number_of_fruits_per_tagged_unit, list(x$Species), FUN=sd)
fitness2021 <- read.csv("2021_fitness_data.csv", header = TRUE)
x <- fitness2021
aggregate(x$Number_of_fruits_per_tagged_unit, list(x$Species), FUN=sd)
na.omit(x)
View(x)
fitness2021 <- read.csv("2021_fitness_data.csv", header = TRUE)
View(fitness2021)
fitness2021 <- read.csv("2021_fitness_data1.csv", header = TRUE)
setwd("/Users/leahvedlhuisen/Library/CloudStorage/OneDrive-UniversityofArizona/Arizona PhD/Research/Chapter 1")
fitness2021 <- read.csv("2021_fitness_data1.csv", header = TRUE)
View(fitness2021)
x <- fitness2021
na.omit(x)
View(x)
fitness2021_double <- fitness2021
na.omit(fitness2021_double)
View(fitness2021_double)
aggregate(fitness2021_double$Number_of_fruits_per_tagged_unit, list(fitness2021_double$Species), FUN=sd)
table <- aggregate(fitness2021_double$Number_of_fruits_per_tagged_unit, list(fitness2021_double$Species), FUN=sd)
View(table)
SD_2021 <- aggregate(fitness2021_double$Number_of_fruits_per_tagged_unit, list(fitness2021_double$Species), FUN=sd)
rm(table)
rm(x)
View(SD_2021)
Year = c(2021)
SD_2021$Year = Year
#standard deviation for 2021 fitness
SD_fruit_2021 <- aggregate(fitness2021_double$Number_of_fruits_per_tagged_unit, list(fitness2021_double$Species), FUN=sd)
Year = c(2021)
SD_2021$Year = Year
#mean for 2021
mean_fruit_2021 <- aggregate(fitness2021_double$Number_of_fruits_per_tagged_unit, list(fitness2021_double$Species), FUN=mean())
#mean for 2021
mean_fruit_2021 <- aggregate(fitness2021_double$Number_of_fruits_per_tagged_unit, list(fitness2021_double$Species), FUN=mean
#mean for 2021
mean_fruit_2021 <- aggregate(fitness2021_double$Number_of_fruits_per_tagged_unit, list(fitness2021_double$Species), FUN=mean)
#mean for 2021
aggregate(fitness2021_double$Number_of_fruits_per_tagged_unit, list(fitness2021_double$Species), FUN=mean)
#mean for 2021
mean_fruit_2021 <- aggregate(fitness2021_double$Number_of_fruits_per_tagged_unit, list(fitness2021_double$Species), FUN=mean)
Year = c(2021)
SD_fruit_2021$Year = Year
rm(SD_2021)
#mean for 2021
mean_fruit_2021 <- aggregate(fitness2021_double$Number_of_fruits_per_tagged_unit, list(fitness2021_double$Species), FUN=mean)
Year = c(2021)
mean_fruit_2021$Year = Year
View(mean_fruit_2021)
library(tidyverse)
View(SD_fruit_2021)
SD_fruit_2021 %>%
rename(
Group.1 = Species,
x = SD fruit
SD_fruit_2021 %>%
rename(
Group.1 = Species,
x = SD fruit)
SD_fruit_2021 %>%
rename(Group.1 = Species,
x = SD fruit)
SD_fruit_2021 %>%
rename(Group.1 = Species,
x = SD_fruit)
SD_fruit_2021 %>%
rename(Group.1 = Species,
x = SD_fruit)
SD_fruit_2021 %>% rename(Group.1 = Species,x = SD_fruit)
SD_fruit_2021 %>% rename(Group.1 = Species, x = SD_fruit)
SD_fruit_2021 %>% rename(Group.1 = Species,SD_fruit_2021$x = SD_fruit)
names(SD_fruit_2021)[1] <- "Species"
names(SD_fruit_2021)[2] <- "SD fruit"
names(mean_fruit_2021)[1] <- "Species"
names(mean_fruit_2021)[2] <- "Mean fruit"
View(mean_fruit_2021)
###standard deviation for 2021 seeds#######
SD_seeds_2021 <- aggregate(fitness2021_double$Seeds.fruit, list(fitness2021_double$Species), FUN=sd)
Year = c(2021)
View(SD_seeds_2021)
Year = c(2021)
SD_seed_2021$Year = Year
names(SD_seeds_2021)[1] <- "Species"
SD_seed_2021$Year = Year
SD_seeds_2021$Year = Year
names(SD_seeds_2021)[1] <- "Species"
names(SD_fruit_2021)[2] <- "SD seeds"
names(mean_fruit_2021)[2] <- "Mean fruit"
View(SD_fruit_2021)
names(SD_fruit_2021)[2] <- "SD fruit"
names(SD_seeds_2021)[2] <- "SD seeds"
###mean for 2021 seeds########
mean_seeds_2021 <- aggregate(fitness2021_double$Seeds.fruit, list(fitness2021_double$Species), FUN=mean)
Year = c(2021)
mean_seeds_2021$Year = Year
View(mean_seeds_2021)
names(mean_seeds_2021)[1] <- "Species"
names(mean_seeds_2021)[2] <- "Mean seeds"
names(SD_fruit_2021)[2] <- "SD fruits per unit"
names(mean_fruit_2021)[2] <- "Mean fruit per unit"
names(SD_seeds_2021)[2] <- "SD seeds per fruit"
names(mean_seeds_2021)[2] <- "Mean seeds per fruit"
##2022----------------------------------------------------------
fitness2022 <- read.csv("2022_fitness_data.csv", header = TRUE)
View(fitness2022)
##2022----------------------------------------------------------
fitness2022 <- read.csv("2022_fitness_data.csv", header = TRUE)
na.omit(fitness2022)
###standard deviation for 2022 fruit#######
SD_fruit_2022 <- aggregate(fitness2022$Number_fruits_per_unit, list(fitness2022$Species), FUN=sd)
Year = c(2022)
SD_fruit_2022$Year = Year
names(SD_fruit_2022)[1] <- "Species"
names(SD_fruit_2022)[2] <- "SD fruits per unit"
View(SD_fruit_2022)
###mean for 2022 fruit########
mean_fruit_2022 <- aggregate(fitness2022$Number_fruits_per_unit, list(fitness2022$Species), FUN=mean)
Year = c(2022)
mean_fruit_2022$Year = Year
names(mean_fruit_2022)[1] <- "Species"
names(mean_fruit_2022)[2] <- "Mean fruit per unit"
###standard deviation for 2022 seeds#######
SD_seeds_2022 <- aggregate(fitness2022$Seeds_per_fruit, list(fitness2022$Species), FUN=sd)
###standard deviation for 2022 seeds#######
aggregate(fitness2022$Seeds_per_fruit, list(fitness2022$Species), FUN=sd)
###standard deviation for 2022 seeds#######
SD_seeds_2022 <- aggregate(fitness2022$Seeds_per_fruit, list(fitness2022$Species), FUN=sd)
View(SD_seeds_2022)
Year = c(2022)
SD_seeds_2022$Year = Year
names(SD_seeds_2022)[1] <- "Species"
names(SD_seeds_2022)[2] <- "SD seeds per fruit"
names(SD_seeds_2022)[2] <- "SD seeds per fruit"
###mean for 2022 seeds########
mean_seeds_2022 <- aggregate(fitness2022$Seeds_per_fruit, list(fitness2022$Species), FUN=mean)
View(mean_seeds_2022)
###mean for 2022 seeds########
aggregate(fitness2022$Seeds_per_fruit, list(fitness2022$Species), FUN=mean)
warnings()
###mean for 2022 seeds########
na.omit(fitness2022)
aggregate(fitness2022$Seeds_per_fruit, list(fitness2022$Species), FUN=mean)
View(SD_fruit_2021)
##combine 2021 into one table
df_merge <- merge(SD_fruit_2021, mean_fruit_2021, by = "Species",
all.x = TRUE)
View(df_merge)
##combine 2021 into one table
df_merge <- merge(SD_fruit_2021, mean_fruit_2021, by = "Species","Year",
all.x = TRUE)
View(df_merge)
View(mean_fruit_2021)
View(mean_fruit_2021)
##combine 2021 into one table
df_merge <- merge(SD_fruit_2021, mean_fruit_2021, by = "Species","Year",
all.x = FALSE)
##combine 2021 into one table
df_merge <- merge(SD_fruit_2021, mean_fruit_2021, by = "Species","Year")
View(df_merge)
##combine 2021 into one table
df_merge <- merge(SD_fruit_2021, mean_fruit_2021, by = "Species")
df = subset(df_merge, select = -c(Year.x) )
View(df)
rm(df_merge)
merge_seeds <- merge(SD_seeds_2021, mean_seeds_2021, by = "Species")
View(merge_seeds)
df.seeds = subset(merge_seeds, select = -c(Year.x) )
View(df.seeds)
merge_all <- merge(df.seeds, df, by = "Species", "Year.y")
View(merge_all)
merge_all <- merge(df.seeds, df, by = "Species)
merge_all <- merge(df.seeds, df, by = "Species")
df.fruits = subset(df_merge, select = -c(Year.x) )
##combine 2021 into one table
df_merge <- merge(SD_fruit_2021, mean_fruit_2021, by = "Species")
df.fruits = subset(df_merge, select = -c(Year.x) )
View(df.fruits)
merge_all <- merge(df.seeds, df.fruits, by = "Species")
View(merge_all)
merge_all = subset(merge_all, select = -c(Year.y.x) )
merge_all21 = subset(merge_all, select = -c(Year.y.x) )
View(merge_all)
##combine 2022 into one table
df_merge <- merge(SD_fruit_2022, mean_fruit_2022, by = "Species")
View(df_merge)
df.fruits.21 = subset(df_merge, select = -c(Year.x) )
View(df.fruits.21)
df.fruits.22 = subset(df_merge, select = -c(Year.x) )
rm(df.fruits.21)
aggregate(fitness2022$Seeds_per_fruit, list(fitness2022$Species), FUN=mean)
###mean for 2022 seeds########
aggregate(fitness2022$Seeds_per_fruit, list(fitness2022$Species), FUN=mean)
###mean for 2022 seeds########
aggregate(fitness2022$Seeds_per_fruit, list(fitness2022$Species), FUN=mean)
fitness2022_extra <- fitness2022
fitness2022_extra %>%
group_by(Species) %>%
summarise_at(vars(Seeds_per_fruit), list(name = mean))
##2022----------------------------------------------------------
fitness2022 <- read.csv("2022_fitness_data.csv", header = TRUE)
fitness2022_extra <- fitness2022_extra[-c(221, 222, 223, 224,225), ]
View(fitness2022_extra)
fitness2022_extra %>%
group_by(Species) %>%
summarise_at(vars(Seeds_per_fruit), list(name = mean))
fitness2022_extra %>%
group_by(Species) %>%
summarise_at(vars(Seeds_per_fruit), list(name = mean, na.rm = TRUE))
df <-  fitness2022_extra %>%
group_by(Species) %>%
summarise(Mean = mean(Seeds_per_fruit, na.rm = T))
View(df)
View(df.fruits.22)
df <-  fitness2022_extra %>%
group_by(Species) %>%
summarise(Mean = mean(Seeds_per_fruit, na.rm = T))
df <-  fitness2022_extra %>%
group_by(Species) %>%
summarise(Mean = mean(Seeds_per_fruit, na.rm = TRUE))
df <-  fitness2022_extra %>%
group_by(Species) %>%
summarise(Mean = mean(Seeds_per_fruit, na.rm = TRUE, na.action = pass))
df <-  fitness2022_extra %>%
group_by(Species) %>%
summarise(Mean = mean(Seeds_per_fruit, na.rm = TRUE, na.action = na.pass))
fitness2022_extra %>%
group_by(Species) %>%
summarise("mean seeds per fruit" = mean(Seeds_per_fruit, na.rm = TRUE))
View(mean_seeds_2022)
mean_seeds_2022 <- read.csv("2022_mean_seedsperfruit.csv", header = TRUE)
View(mean_seeds_2022)
Year = c(2022)
mean_seeds_2022$Year = Year
names(mean_seeds_2022)[1] <- "Species"
names(mean_seeds_2022)[2] <- "Mean seeds per fruit"
View(df.fruits.22)
names(df.fruits.22)[4] <- "Year"
merge_seeds22 <- merge(SD_seeds_2022, mean_seeds_2022, by = "Species")
df.seeds = subset(merge_seeds, select = -c(Year.x) )
View(merge_seeds22)
df.seeds = subset(merge_seeds, select = -c(Year.x) )
View(df.seeds)
df.seeds22 = subset(merge_seeds22, select = -c(Year.x) )
View(df.seeds22)
names(df.seeds22)[4] <- "Year"
View(df.fruits.22)
View(df.seeds22)
merge_all22 <- merge(df.seeds22, df.fruits.22, by = "Species")
View(merge_all22)
merge_all22 = subset(merge_all22, select = -c(Year.x) )
names(merge_all22)[6] <- "Year"
View(merge_all)
##turn 2021 and 2022 combined tables into excel files
write.csv(merge_all, "/Users/leahvedlhuisen/Library/CloudStorage/OneDrive-UniversityofArizona/Arizona PhD/Research/Chapter 1"\fitness_summary2021.csv", row.names=FALSE)
##turn 2021 and 2022 combined tables into excel files
write.csv(merge_all, "/Users/leahvedlhuisen/Library/CloudStorage/OneDrive-UniversityofArizona/Arizona PhD/Research/Chapter 1\\fitness_summary2021.csv", row.names=FALSE)
##turn 2021 and 2022 combined tables into excel files
write.csv(merge_all, "/Users/leahvedlhuisen/Library/CloudStorage/OneDrive-UniversityofArizona/Arizona PhD/Research/Chapter 1\fitness_summary2021.csv", row.names=FALSE)
write.csv(merge_all22, "/Users/leahvedlhuisen/Library/CloudStorage/OneDrive-UniversityofArizona/Arizona PhD/Research/Chapter 1\fitness_summary2022.csv", row.names=FALSE)
